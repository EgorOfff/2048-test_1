(()=>{"use strict";var e={151:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(81),n=i.n(s),o=i(645),a=i.n(o)()(n());a.push([e.id,'html {\r\n    font-family: "Arial";\r\n}\r\n\r\nbody {\r\n    display: flex;\r\n    justify-content: center;\r\n    text-align: center;\r\n    margin-top: 100px;\r\n    margin-bottom: 200px;\r\n}\r\n\r\n.main {\r\n    width: 500px;\r\n    margin-left: 20%;\r\n    margin-right: 20%;\r\n}\r\n\r\n.game-title {\r\n    font-size: 80px;\r\n}\r\n\r\n.score-box {\r\n    margin: 0 auto;\r\n    width: 244px;\r\n    height: 59px;\r\n    border-radius: 30px;\r\n    background-color: #dadada;\r\n    border-color: #9e9e9e;\r\n    border-style: solid;\r\n    border-width: 5px;\r\n    position: relative;\r\n}\r\n\r\n.score-label {\r\n    font-size: 32px;\r\n    position: absolute;\r\n    left: 35%;\r\n    top: 50%;\r\n    transform: translate(-50%, -50%);\r\n}\r\n\r\n.canvas-container {\r\n    width: 100%;\r\n    text-align: center;\r\n}\r\n\r\n#game-canvas {\r\n    margin-top: 40px;\r\n    display: inline;\r\n    border-radius: 10px;\r\n    background-color: #cfc0af;\r\n    border-color: #9e9e9e;\r\n    border-style: solid;\r\n    border-width: 5px;\r\n}',""]);const r=a},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i="",s=void 0!==t[5];return t[4]&&(i+="@supports (".concat(t[4],") {")),t[2]&&(i+="@media ".concat(t[2]," {")),s&&(i+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),i+=e(t),s&&(i+="}"),t[2]&&(i+="}"),t[4]&&(i+="}"),i})).join("")},t.i=function(e,i,s,n,o){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(s)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(a[l]=!0)}for(var h=0;h<e.length;h++){var c=[].concat(e[h]);s&&a[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),i&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=i):c[2]=i),n&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=n):c[4]="".concat(n)),t.push(c))}},t}},81:e=>{e.exports=function(e){return e[1]}},379:e=>{var t=[];function i(e){for(var i=-1,s=0;s<t.length;s++)if(t[s].identifier===e){i=s;break}return i}function s(e,s){for(var o={},a=[],r=0;r<e.length;r++){var l=e[r],h=s.base?l[0]+s.base:l[0],c=o[h]||0,d="".concat(h," ").concat(c);o[h]=c+1;var m=i(d),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==m)t[m].references++,t[m].updater(u);else{var p=n(u,s);s.byIndex=r,t.splice(r,0,{identifier:d,updater:p,references:1})}a.push(d)}return a}function n(e,t){var i=t.domAPI(t);return i.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,n){var o=s(e=e||[],n=n||{});return function(e){e=e||[];for(var a=0;a<o.length;a++){var r=i(o[a]);t[r].references--}for(var l=s(e,n),h=0;h<o.length;h++){var c=i(o[h]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}o=l}}},569:e=>{var t={};e.exports=function(e,i){var s=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(i)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,i)=>{e.exports=function(e){var t=i.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(i){!function(e,t,i){var s="";i.supports&&(s+="@supports (".concat(i.supports,") {")),i.media&&(s+="@media ".concat(i.media," {"));var n=void 0!==i.layer;n&&(s+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),s+=i.css,n&&(s+="}"),i.media&&(s+="}"),i.supports&&(s+="}");var o=i.sourceMap;o&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(s,e,t.options)}(t,e,i)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={id:s,exports:{}};return e[s](o,o.exports,i),o.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.nc=void 0,(()=>{var e=i(379),t=i.n(e),s=i(795),n=i.n(s),o=i(569),a=i.n(o),r=i(565),l=i.n(r),h=i(216),c=i.n(h),d=i(589),m=i.n(d),u=i(151),p={};p.styleTagTransform=m(),p.setAttributes=l(),p.insert=a().bind(null,"head"),p.domAPI=n(),p.insertStyleElement=c(),t()(u.Z,p),u.Z&&u.Z.locals&&u.Z.locals;class g{constructor(e,t,i,s){this.id=e,this.cellHeight=t.cellHeight,this.gameHeight=t.gameHeight,this.padding=t.padding,this.position={x:i[0],y:i[1]},this.game=t,this.value=s,this.maxSpeed=70,this.speed=0,this.movementAxis="x",this.backgroundColors={2:"#eee4d9",4:"#ede0c7",8:"#f9b376",16:"#ff9b60",32:"#ca6a49",64:"#ec6233",128:"#e8c562",256:"#dfba55",512:"#f3c54b",1024:"#f2c138",2048:"#f2bd28"}}draw(e){e.fillStyle=this.value>2048?"#000000":this.backgroundColors[this.value],e.fillRect(this.position.x,this.position.y,this.cellHeight,this.cellHeight,10),e.font="60px sans-serif",e.fillStyle="#000000",this.value<10?e.fillText(this.value,this.position.x+40,this.position.y+80):this.value>=10&&this.value<100?e.fillText(this.value,this.position.x+23,this.position.y+80):this.value>=100&&this.value<1e3?e.fillText(this.value,this.position.x+9,this.position.y+80):this.value>=1e3&&this.value<1e4&&(e.font="48px sans-serif",e.fillText(this.value,this.position.x+5,this.position.y+80))}get top(){return this.position.y}get right(){return this.position.x+this.cellHeight}get bottom(){return this.position.y+this.cellHeight}get left(){return this.position.x}checkCollusion(e){return this.bottom<e.top||this.left>e.right||this.top>e.bottom||this.right<e.left?(this.topColided=!1,this.bottomColided=!1,this.rightColided=!1,this.leftColided=!1,!1):(e.speed<0&&"y"===e.movementAxis&&this.value===e.value?this.game.mergeCells(this,e,Object.values(this.position)):this.speed<0&&"y"===this.movementAxis&&this.value===e.value?this.game.mergeCells(this,e,Object.values(e.position)):this.speed<0&&"y"===this.movementAxis?(this.topColided=!0,this.speed=0,this.position.y=e.position.y+this.padding+this.cellHeight):e.speed<0&&"y"===e.movementAxis?(e.topColided=!0,e.speed=0,e.position.y=this.position.y+e.padding+e.cellHeight):this.speed>0&&"y"===this.movementAxis&&this.value===e.value?this.game.mergeCells(this,e,Object.values(e.position)):e.speed>0&&"y"===e.movementAxis&&this.value===e.value?this.game.mergeCells(this,e,Object.values(this.position)):e.speed>0&&"y"===e.movementAxis?(e.bottomColided=!0,e.speed=0,e.position.y=this.position.y-e.padding-e.cellHeight):this.speed>0&&"y"===this.movementAxis?(this.bottomColided=!0,this.speed=0,this.position.y=e.position.y-this.padding-this.cellHeight):this.speed>0&&"x"===this.movementAxis&&this.value===e.value?this.game.mergeCells(this,e,Object.values(e.position)):e.speed>0&&"x"===e.movementAxis&&this.value===e.value?this.game.mergeCells(this,e,Object.values(this.position)):this.speed>0&&"x"===this.movementAxis?(this.rightColided=!0,this.speed=0,this.position.x=e.position.x-this.padding-this.cellHeight):e.speed>0&&"x"===e.movementAxis?(e.rightColided=!0,e.speed=0,e.position.x=this.position.x-e.padding-e.cellHeight):this.speed<0&&"x"===this.movementAxis&&this.value===e.value?this.game.mergeCells(this,e,Object.values(e.position)):e.speed<0&&"x"===e.movementAxis&&this.value===e.value?this.game.mergeCells(this,e,Object.values(this.position)):this.speed<0&&"x"===this.movementAxis?(this.leftColided=!0,this.speed=0,this.position.x=e.position.x+this.padding+this.cellHeight):e.speed<0&&"x"===e.movementAxis&&(e.leftColided=!0,e.speed=0,e.position.x=this.position.x+e.padding+e.cellHeight),this.isCollided=!0,!0)}update(e){e&&(this.position[this.movementAxis]+=this.speed,this.position.x<0?(this.speed=0,this.position.x=0):this.position.x>this.gameHeight-this.cellHeight-this.padding?(this.speed=0,this.position.x=this.gameHeight-this.cellHeight-this.padding):this.position.y<0?(this.speed=0,this.position.y=0):this.position.y>this.gameHeight-this.cellHeight-this.padding&&(this.speed=0,this.position.y=this.gameHeight-this.cellHeight-this.padding))}moveRight(){0==this.speed&&(this.movementAxis="x",this.speed=this.maxSpeed)}moveLeft(){0==this.speed&&(this.movementAxis="x",this.speed=-this.maxSpeed)}moveUp(){0==this.speed&&(this.movementAxis="y",this.speed=-this.maxSpeed)}moveDown(){0==this.speed&&(this.movementAxis="y",this.speed=this.maxSpeed)}}class v{constructor(e){document.addEventListener("swipe",(t=>{if(!t.repeat)switch(t.detail.dir){case"up":e.moveUp();break;case"right":e.moveRight();break;case"down":e.moveDown();break;case"left":e.moveLeft()}}))}}const f=document.getElementById("game-canvas");let x=f.getContext("2d");const b=document.getElementById("score-value-canvas").getContext("2d"),y=510;let C=new class{constructor(e,t,i){this.cellHeight=t,this.gameHeight=e,this.padding=i,this.allLocations=this.generateAllLocations(),this.gameMovingObjects=[],this.currentScore=0,this.chance=.1,this.moveCellEnd=!0}generateAllLocations(){const e=this.gameHeight+this.cellHeight,t=this.cellHeight+this.padding,i=[];for(let s=0;s<e-t;s+=t)for(let n=0;n<e-t;n+=t)i.push([n,s]);return i}generateCellId(){return Math.random()}calculateCurrentScore(e=0,t=0){this.currentScore+=e,this.currentScore+=t}generateRandomLocation(){const e=this.gameMovingObjects.map((e=>Object.values(e.position))),t=this.allLocations.filter((t=>!JSON.stringify(e).includes(JSON.stringify(t))));return t[parseInt(Math.random()*t.length)]}addCell(){this.gameMovingObjects.length>=16||setTimeout((()=>{let e=this.generateRandomLocation();const t=this.generateCellId();let i;i=this.gameMovingObjects.length<3?new g(t,this,e,2):new g(t,this,e,this.randCellValue()),this.gameMovingObjects.push(i),new v(i)}),100)}randCellValue(){let e=2;return Math.random()<this.chance&&(e=4),e}deleteCellById(e){let t=-1;for(let i=0;i<this.gameMovingObjects.length;i++)if(this.gameMovingObjects[i].id===e){t=i;break}return-1===t?"Not found":(this.gameMovingObjects.splice(t,1),"Deleted!")}mergeCells(e,t,i){const s=this.generateCellId(),n=new g(s,this,i,e.value+t.value);this.gameMovingObjects.push(n),new v(n),this.deleteCellById(e.id),this.deleteCellById(t.id),this.calculateCurrentScore(e.value,t.value)}update(e){for(let e=0;e<this.gameMovingObjects.length;e++){const t=this.gameMovingObjects[e];for(let i=0;i<this.gameMovingObjects.length;i++)if(void 0!==this.gameMovingObjects[e]&&void 0!==this.gameMovingObjects[i]&&this.gameMovingObjects[e].id!==this.gameMovingObjects[i].id){const e=this.gameMovingObjects[i];t.checkCollusion(e)}}this.moveCellEnd=this.gameMovingObjects.some((e=>0!=e.speed)),this.gameMovingObjects.forEach((t=>t.update(e)))}draw(e,t){t.font="36px areal",t.fillStyle="#000000",t.fillText(String(this.currentScore),145,40),this.gameMovingObjects.forEach((t=>t.draw(e)))}getRow(e){const t=[];return this.gameMovingObjects.forEach((i=>{i.position.y===e&&t.push(i)})),t}getColumn(e){const t=[];return this.gameMovingObjects.forEach((i=>{i.position.x===e&&t.push(i)})),t}hasConsecutiveEqualValues(e){let t=!1;return e.forEach(((i,s)=>{e[s+1]&&i.value===e[s+1].value&&(t=!0)})),t}getAllColumns(){const e=[];for(let t=0;t<=375;t+=125)e.push(this.getColumn(t));return e}getAllRows(){const e=[];for(let t=0;t<=375;t+=125)e.push(this.getRow(t));return e}checkGameOver(){let e=this.getAllRows(),t=this.getAllColumns();return this.gameOverBool=!0,this.gameMovingObjects.length<16&&(this.gameOverBool=!1),this.gameMovingObjects.some((e=>2048===e.value))&&(this.gameOverBool=!0),e.forEach((e=>{e.sort(((e,t)=>e.position.x-t.position.x)),this.hasConsecutiveEqualValues(e)&&(this.gameOverBool=!1)})),t.forEach((e=>{e.sort(((e,t)=>e.position.y-t.position.y)),this.hasConsecutiveEqualValues(e)&&(this.gameOverBool=!1)})),this.gameOverBool}}(y,117.5,10),w=0;!function(e,t){(t=Object.assign({},{minDist:60,maxDist:120,maxTime:700,minTime:50},t)).maxTime<t.minTime&&(t.maxTime=t.minTime+500),(t.maxTime<100||t.minTime<50)&&(t.maxTime=700,t.minTime=50);var i,s,n,o=!1,a=!1,r=0,l=0,h=0,c=0,d=0,m=!(!("PointerEvent"in window)&&!("msPointerEnabled"in window.navigator)),u=!!(void 0!==window.orientation||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||"ontouchstart"in window||navigator.msMaxTouchPoints||"maxTouchPoints"in window.navigator>1||"msMaxTouchPoints"in window.navigator>1),p=function(e){return e.changedTouches?e.changedTouches[0]:e},g=function(r){if(!o||a){var h=(new Date).getTime()-d;if(h>=t.minTime&&h<=t.maxTime&&(Math.abs(l)>=t.minDist&&Math.abs(c)<=t.maxDist||Math.abs(c)>=t.minDist&&Math.abs(l)<=t.maxDist)&&(s=i),n="left"===i||"right"===i?Math.abs(l):Math.abs(c),"none"!==s&&n>=t.minDist){var m=new CustomEvent("swipe",{bubbles:!0,cancelable:!0,detail:{full:r,dir:s,dist:n,time:h}});e.dispatchEvent(m)}}else a=!1},v=function(){switch(!0){case m:v={type:"pointer",start:"PointerDown",move:"PointerMove",end:"PointerUp",cancel:"PointerCancel",leave:"PointerLeave"};var e=window.navigator.msPointerEnabled&&Function("/*@cc_on return document.documentMode===10@*/")();for(var t in v)"type"!==t&&(v[t]=e?"MS"+v[t]:v[t].toLowerCase());break;case u:v={type:"touch",start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"};break;default:v={type:"mouse",start:"mousedown",move:"mousemove",end:"mouseup",leave:"mouseleave"}}return v}();(m&&!u||"mouse"===v.type)&&(o=!0),e.addEventListener(v.start,(function(e){var t=p(e);u&&void 0!==e.touches&&1!==e.touches.length||(i="none",s="none",n=0,r=t.pageX,h=t.pageY,d=(new Date).getTime(),o&&(a=!0))})),e.addEventListener(v.move,(function(e){if(!o||a){var t=p(e);l=t.pageX-r,c=t.pageY-h,i=Math.abs(l)>Math.abs(c)?l<0?"left":"right":c<0?"up":"down"}})),e.addEventListener(v.end,g),m&&u&&e.addEventListener("lostpointercapture",g)}(f,{maxTime:1e3,minTime:100,maxDist:150,minDist:60}),document.addEventListener("DOMContentLoaded",(function(){function e(t){console.log(C.moveCellEnd);let i=t-w;w=t,b.clearRect(130,0,100,100),x.clearRect(0,0,y,y),C.update(i),C.draw(x,b),requestAnimationFrame(e),C.checkGameOver()&&(alert("Нельзя сделать ход"),x.clearRect(0,0,y,y),b.clearRect(130,0,100,100),C.currentScore=0,C.gameMovingObjects=[],C.gameOverBool=!1,C.addCell(),C.addCell(),e())}x.clearRect(0,0,y,y),requestAnimationFrame(e),C.currentScore=0,C.addCell(),C.addCell(),C.moveCellEnd&&f.addEventListener("swipe",(e=>{e.detail&&C.addCell()}),!1),e()}))})()})();